<!DOCTYPE html>
<html>

    <head>
        <title>Variational Inference</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- theme -->
        <link rel="stylesheet" href="/assets/css/prism.css"/>
        <!-- UIKit -->
        <link rel="stylesheet" href="/assets/css/uikit.min.css"/>
        <script src="/assets/js/uikit.min.js"></script>
        <script src="/assets/js/uikit-icons.min.js"></script>
        <!-- Prism -->
        <link rel="stylesheet" href="/assets/css/theme.css"/>
        <script src="/assets/js/prism.js"></script>
        <!-- GoogleFonts -->
        <link href="https://fonts.googleapis.com/css?family=Lora" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet">
        <!-- KaTeX -->
        <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css">
        <script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js"></script>
    </head>

    <body class="uk-background uk-height-viewport">

        <div class="tm-navbar-container" uk-sticky="animation: uk-animation-slide-top; sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky; cls-inactive: uk-navbar-transparent; top: 300">

    <nav class="uk-navbar-container" uk-navbar style="position: relative; z-index: 980;">

        <div class="uk-navbar-center">

            <div class="uk-navbar-center-left">
                <div>
                    <ul class="uk-navbar-nav">
                        
                            <li class="uk-active"><a class="tm-navbar-item" href="/index.html">Blog</a></li>
                        

                        
                            <li><a class="tm-navbar-item" href="/info.html">Info</a></li>
                        
                    </ul>
                </div>
            </div>

            <a class="uk-navbar-item uk-logo" href="#">
                <img uk-svg src="/assets/img/penguin.svg" style="width:56px; height: 56px;">
            </a>

            <div class="uk-navbar-center-right">
                <div>
                    <ul class="uk-navbar-nav">
                        <li>
                            <a href="https://github.com/cswaney" uk-icon="icon: github; ratio: 1.5"></a>
                        </li>
                        <li>
                            <a href="https://twitter.com/SwaneyColin?lang=en" uk-icon="icon: twitter; ratio: 1.5"></a>
                        </li>
                    </ul>
                </div>
            </div>

        </div>

    </nav>

</div>


        <div class="uk-section uk-section-default uk-section-small uk-padding-remove-top uk-margin-small-top">

                <div class="uk-container uk-container-small uk-position-relative">

    <div>
        <article class="uk-article">

            <h1 class="uk-article-title"><a class="uk-link-reset" href="">Variational Inference</a></h1>

            <p class="uk-article-meta tm-article-meta">Written by <a href="#">Colin Swaney</a> on Monday, June 1, 2020</a></p>

            <!-- tags... -->

            <h2 id="setting">Setting</h2>
<ul>
  <li>Assume a joint distribution of the form</li>
</ul>

<script type="math/tex; mode=display">p(x, z, \beta \ | \ \alpha) = p(\beta \ | \ \alpha) \prod_{n=1}^N p(x_n, z_n \ | \ \beta)</script>

<ul>
  <li><script type="math/tex">\beta</script> is a global variable with hyperparameter <script type="math/tex">\alpha</script></li>
  <li><script type="math/tex">x = x_{1:N}</script> is the data/observations</li>
  <li><script type="math/tex">z = z_{1:N}</script> are local variables</li>
  <li>
    <p>We call <script type="math/tex">\{x_n, z_n\}</script> the <script type="math/tex">n</script>th “local context” (local in the sense that they are conditionally independent given the global variables, <script type="math/tex">\beta</script>).</p>
  </li>
  <li>Assume that the “complete conditionals” are in the exponential family:</li>
</ul>

<script type="math/tex; mode=display">p(\beta \ | \ x, z, \alpha) = h(\beta) \exp \{ \eta_g(x, z, \alpha)^{\intercal} t(\beta) - a_g(\eta_g(x, z, \alpha)) \}</script>

<script type="math/tex; mode=display">p(z \ | \ x, \beta) = h(z) \exp \{ \eta_l(x, \beta)^{\intercal} t(z) - a_l(\eta_l(x, \beta)) \}</script>

<ul>
  <li>Assume that the prior distribution is also in the exponential family:</li>
</ul>

<script type="math/tex; mode=display">p(\beta) = h(\beta) \exp \{ \alpha^\intercal t(\beta) - a_g(\alpha) \}</script>

<ul>
  <li>These assumptions imply that the global variable has a complete conditional in the same exponential family as the prior with natural parameter</li>
</ul>

<script type="math/tex; mode=display">\eta_g(x, z, \alpha) = (\alpha_1 + \sum_{n=1}^N t(z_n, x_n), \alpha_2 + N)</script>

<h2 id="mean-field-variational-inference">Mean-Field Variational Inference</h2>
<ul>
  <li>
    <p>Variational inference is based on converting the inference problem into an optimization problem. The value to be optimized—the “variational objective”—is called the “evidence lower bound”, so-called because it describes a lower bound on the “evidence” <script type="math/tex">p(x)</script>.</p>
  </li>
  <li>
    <p>Suppose we introduce a distribution <script type="math/tex">q(z, \beta)</script> that we think of as an approximation to <script type="math/tex">p(z, \beta \ \vert \ x)</script>. Using Jensen’s inequality, we can show that</p>
  </li>
</ul>

<script type="math/tex; mode=display">\log p(x) \ge \mathbb{E}_q \left[ \log p(x, z, \beta) \right] - \mathbb{E}_q \left[ \log q(z, \beta) \right] = \text{ELBO}</script>

<ul>
  <li>Alternative, consider the KL divergence between <script type="math/tex">p(z, \beta \ \vert \ x)</script> and <script type="math/tex">q(z, \beta)</script>:</li>
</ul>

<script type="math/tex; mode=display">\text{KL}(q, p) = \mathbb{E}_q \left[ \log q(z, \beta) \right] - \mathbb{E}_q \left[ \log p(z, \beta \ \vert \ x) \right] = - \text{ELBO} + \text{const}.</script>

<ul>
  <li>
    <p>Minimizing the ELBO is thus equivalent to selecting the distribution <script type="math/tex">q(z, \beta)</script> that is closest to the posterior.</p>
  </li>
  <li>
    <p>The “mean-field” family of variational distributions is a fully-factorized distribution</p>
  </li>
</ul>

<script type="math/tex; mode=display">q(z, \beta) = q(\beta \ \vert \ \lambda) \prod_{n=1}^N q(z_n \ \vert \ \phi_n)</script>

<ul>
  <li>Moreover, we assume that the marginals belong to the same exponential family as the complete conditionals, with natural parameters equal to <script type="math/tex">\lambda</script> and <script type="math/tex">\phi_n</script> above:</li>
</ul>

<script type="math/tex; mode=display">q(\beta \ \vert \ \lambda) = h(\beta) \exp \{ \lambda^{\intercal} t(\beta) - a_g(\lambda) \}</script>

<script type="math/tex; mode=display">q(z \ \vert \ \phi_n) = h(z_n) \exp \{ \phi_n^\intercal t(z_n) - a_l(\phi_n) \}</script>

<ul>
  <li>Under these assumptions, we can calculate the ELBO as well as its gradient. It can be shown that:</li>
</ul>

<script type="math/tex; mode=display">\nabla_\lambda \text{ELBO} = 0 \iff \lambda = \mathbb{E} \left[ \eta_g(x, z, \alpha) \right]</script>

<script type="math/tex; mode=display">\nabla_{\phi_n} \text{ELBO} = 0 \iff \phi_n = \mathbb{E} \left[ \eta_l(x, \beta) \right]</script>

<ul>
  <li>This implies the following coordinate ascent algorithm maximizes the ELBO:</li>
</ul>

<p><strong>NOTE</strong>: The algorithm requires an update to <strong>every</strong> local variable before the global parameter is updated. This is quite wasteful.</p>

<h2 id="stochastic-variational-inference">Stochastic Variational Inference</h2>

<h3 id="natural-gradients-a-detour">Natural Gradients: a Detour</h3>


        </article>

    </div>

    <div style="position: absolute; width: 200px; top: 0px; left: 860px;">
        <div uk-sticky="offset: 260">
            <ul class="uk-nav uk-nav-default uk-nav-parent-icon tm-nav" uk-scrollspy-nav="closest: li; scroll: true; offset: 100">
                
            </ul>
        </div>
    </div>

    <div id="disqus_thread" class="uk-margin-large-top"></div>
    <script>
        /**
        *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
        *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
        /*
        var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };
        */
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = 'https://katabaticwindblog.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</div>


        </div>

        <div class="uk-section uk-section-xsmall tm-footer">
    <div class="uk-container uk-container-small uk-position-relative">
        <ul class="uk-navbar-nav uk-align-center">
            <li>
                <a href="#">cswaney.github.io</a>
            </li>
            <!-- <li>
                <p class="uk-text-center uk-text-small">Created with <a href="https://getuikit.com" uk-icon="icon: uikit; ratio: 1.0"></a></p>
            </li> -->
        </ul>
    </div>
</div>


        <!-- convert MathJax to KaTex -->
        <script>
          $("script[type='math/tex']").replaceWith(function() {
              var tex = $(this).text();
              return katex.renderToString(tex.replace(/%.*/g, ''), {displayMode: false});
          });

          $("script[type='math/tex; mode=display']").replaceWith(function() {
              var tex = $(this).html();
              return katex.renderToString(tex.replace(/%.*/g, ''), {displayMode: true});
          });
        </script>

    </body>

</html>
