<!DOCTYPE html>
<html>

    <head>
        <title>Event-Driven Bayesian Models (Pt. II)</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- theme -->
        <link rel="stylesheet" href="/assets/css/prism.css"/>
        <!-- UIKit -->
        <link rel="stylesheet" href="/assets/css/uikit.min.css"/>
        <script src="/assets/js/uikit.min.js"></script>
        <script src="/assets/js/uikit-icons.min.js"></script>
        <!-- Prism -->
        <link rel="stylesheet" href="/assets/css/theme.css"/>
        <script src="/assets/js/prism.js"></script>
        <!-- GoogleFonts -->
        <link href="https://fonts.googleapis.com/css?family=Lora" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet">
        <!-- KaTeX -->
        <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css">
        <script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js"></script>
    </head>

    <body class="uk-background uk-height-viewport">

        <div class="tm-navbar-container" uk-sticky="animation: uk-animation-slide-top; sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky; cls-inactive: uk-navbar-transparent; top: 300">

    <nav class="uk-navbar-container" uk-navbar style="position: relative; z-index: 980;">

        <div class="uk-navbar-center">

            <div class="uk-navbar-center-left">
                <div>
                    <ul class="uk-navbar-nav">
                        
                            <li class="uk-active"><a class="tm-navbar-item" href="/index.html">Blog</a></li>
                        

                        
                            <li><a class="tm-navbar-item" href="/info.html">Info</a></li>
                        
                    </ul>
                </div>
            </div>

            <a class="uk-navbar-item uk-logo" href="#">
                <img uk-svg src="/assets/img/penguin.svg" style="width:56px; height: 56px;">
            </a>

            <div class="uk-navbar-center-right">
                <div>
                    <ul class="uk-navbar-nav">
                        <li>
                            <a href="https://github.com/cswaney" uk-icon="icon: github; ratio: 1.5"></a>
                        </li>
                        <li>
                            <a href="https://twitter.com/SwaneyColin?lang=en" uk-icon="icon: twitter; ratio: 1.5"></a>
                        </li>
                    </ul>
                </div>
            </div>

        </div>

    </nav>

</div>


        <div class="uk-section uk-section-default uk-section-small uk-padding-remove-top uk-margin-small-top">

                <div class="uk-container uk-container-small uk-position-relative">

    <div>
        <article class="uk-article">

            <h1 class="uk-article-title"><a class="uk-link-reset" href="">Event-Driven Bayesian Models (Pt. II)</a></h1>

            <p class="uk-article-meta tm-article-meta">Written by <a href="#">Colin Swaney</a> on Friday, May 1, 2020</a></p>

            <!-- tags... -->

            <p>We left off by introducing a model that combines a network model with a temporal model of event arrivals called a Hawkes model. The intensity of the <script type="math/tex">n</script>-th node in this model at time <script type="math/tex">t</script> is given by</p>

<script type="math/tex; mode=display">% <![CDATA[
\lambda_n(t) = \lambda_n^{(0)} + \sum_{s_m < t} A_{c_m, n} \cdot W_{c_m, n} \cdot \theta_{c_m, n} \cdot e^{-\theta_{c_m, n} (t - s_m)}, %]]></script>

<p>where <script type="math/tex">A_{c_m, n} \in \{0, 1\}</script>.</p>

<p>Simulating the model is fairly straight-forward using the Poisson Superposition Principle. First, simulate a network <script type="math/tex">A</script> according to the generative model chosen (see previous lecture for details). Next, simulate independent events on each node according a to Poisson process with intensity given by the background rate, <script type="math/tex">\lambda_{n}^{(0)}</script>. Finally, for each event generated by the background process, recursively generate <em>independent</em> Poisson processes with intensity given by the impulse response functions.</p>

<h2 id="inference">Inference</h2>
<p>Now suppose we observe a sequence of events <script type="math/tex">\{ s_m, c_m \}</script>, where <script type="math/tex">c_m \in \{1, \cdots, N\}</script> represents the node of the event. How can we learn about the model parameters? Let’s take a look at some of the standard approaches.</p>

<h3 id="maximum-likelihood-estimation-mle">Maximum Likelihood Estimation (MLE)</h3>
<p>The classic approach to is to find the parameters <script type="math/tex">\{ \lambda^{(0)}, A, W, \theta \}</script> that maximize the likelihood of the data. This requires us to be above to (at a minimum) evaluate the likelihood given any set of parameter values. One way to accomplish this is by introducing auxillay parent variables <script type="math/tex">\omega_m</script> denoting the order of the event that “caused” the <script type="math/tex">m</script>-th event (or zero is this event occurred on the background process). As the processes directly generated by each parent event are independent, we can apply the Poisson Superposition Principle to compute the likelihood of augmented data:</p>

<script type="math/tex; mode=display">L( \{s_m, c_m, \omega_m\} \ | \ \lambda^{(0)}, A, W, \theta) = \prod_{n=1}^N \mathcal{PP} \left( \lambda_n^{(0)} \right) \prod_{m=1}^M \mathcal{PP} \left( h_{c_{\omega_m}, c_m} \right)</script>

<p>To compute the likelihood, we sum over all possible values of each <script type="math/tex">\omega_m</script>:</p>

<script type="math/tex; mode=display">% <![CDATA[
L( \{s_m, c_m, \omega_m\} \ | \ \lambda^{(0)}, A, W, \theta) = \prod_{n=1}^N \mathcal{PP} \left( \lambda_n^{(0)} \right) \prod_{m=1}^M \mathcal{PP} \left( \sum_{\ \omega_m < m} h_{c_{\omega_m}, c_m} \right). %]]></script>

<p>The unfortunate feature of this likelihood is that it requires <script type="math/tex">\mathcal{O}(M^2)</script> evaluations of impulse-response functions because <em>every</em> event prior to the <script type="math/tex">m</script>-th is a potential parent (despite the fact that the probability decays exponentially). Nonetheless, we can evaluate the likelihood and maximize it numerically using standard methods. <strong>NOTE</strong>: All of the model parameters are constrained to be non-negative!</p>

<h2 id="maximum-a-posteriori-estimation-map">Maximum a Posteriori Estimation (MAP)</h2>
<p>As an alternative point estimation, we can calculate the parameters that maximize the posterior distribution. Recall that the posterior distribution of a model with likelihood <script type="math/tex">p(\mathcal{D} \ | \ \Theta)</script> and prior distribution <script type="math/tex">p(\Theta \ | \ \nu)</script> is given by</p>

<script type="math/tex; mode=display">p(\Theta \ | \ \mathcal{D}, \nu) = \frac{p(\mathcal{D} \ | \ \Theta) p(\Theta \ | \ \nu)}{p(\mathcal{D})},</script>

<p>where <script type="math/tex">\mathcal{D}</script> represents the observed data, and <script type="math/tex">\nu</script> represents the hyperparameters governing the prior distribution. The denominator is a constant with respect to <script type="math/tex">\Theta</script>. Thus, maximizing the posterior distribution is equivalent to maximizing the denominator. We have already seen how to calculate the likelihood. Let’s introduce priors on the model parameters.</p>

<p>When the impulse-response rate is parameterized as an exponential function, it turns out that the conditional marginal distribution of each of model parameters is conjugate with a Gamma distribution:</p>

<script type="math/tex; mode=display">\lambda_n^{(0)} \sim Gamma\left(\alpha_0, \beta_0 \right)</script>

<script type="math/tex; mode=display">W_{n, m} \sim Gamma\left(\alpha_W, \beta_W \right)</script>

<script type="math/tex; mode=display">\theta_{n, m} \sim Gamma\left(\alpha_\theta, \beta_\theta \right)</script>

<p>The priors are independent, and the joint prior is therefore the product of the individual priors. With this information, we can again use standard numerical optimization methods to calculate <script type="math/tex">\Theta_{MAP}</script>.</p>

<h2 id="bayesian-inference">Bayesian Inference</h2>
<p>MLE and MAP point estimates provide incomplete pictures of the model parameters. To fully explore the model, we would like to be able to sample from the full (marginal) posterior distributions. We can use the MCMC technique known as Gibbs sampling to do so. (Gibbs sampling works by sampling from the conditional <em>marginal</em> distributions, which are often tractable, as is the present case).</p>

<p>Our decision to use gamma priors now allows us to easily sample the conditional marginal distributions, which are all gamma due to conjugacy.</p>

<script type="math/tex; mode=display">\lambda_n^{(0)} \sim Gamma(\alpha_0 + M_n, \beta_0 + T).</script>

<p>Intuitively, the posterior distribution updates the prior belief of <script type="math/tex">\alpha_0</script> events per <script type="math/tex">\beta_0</script> time periods. Similarly, we have</p>

<script type="math/tex; mode=display">W_{n,m} \sim Gamma(\alpha_W + M_{n,m}, \beta_0 + M_m).</script>

<p>Again, <script type="math/tex">W_{n,m}</script> equals the expected number of events on node <script type="math/tex">m</script> generated by an event on node <script type="math/tex">n</script>. The posterior distribution reflects updating beliefs from <script type="math/tex">\alpha_W/\beta_W</script> towards the empirical rate, <script type="math/tex">M_{n,m} / M_n</script>.</p>

<p>Finally, the impulse-response likelihood is also conjugate with its gamma distribution prior…</p>

<script type="math/tex; mode=display"></script>

<h2 id="examples">Examples</h2>
<p>Let’s look at some examples of these methods in action…</p>

<h3 id="mle">MLE</h3>

<h3 id="map">MAP</h3>

<h3 id="mcmc">MCMC</h3>


        </article>

    </div>

    <div style="position: absolute; width: 200px; top: 0px; left: 860px;">
        <div uk-sticky="offset: 260">
            <ul class="uk-nav uk-nav-default uk-nav-parent-icon tm-nav" uk-scrollspy-nav="closest: li; scroll: true; offset: 100">
                
            </ul>
        </div>
    </div>

    <div id="disqus_thread" class="uk-margin-large-top"></div>
    <script>
        /**
        *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
        *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
        /*
        var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };
        */
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = 'https://katabaticwindblog.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</div>


        </div>

        <div class="uk-section uk-section-xsmall tm-footer">
    <div class="uk-container uk-container-small uk-position-relative">
        <ul class="uk-navbar-nav uk-align-center">
            <li>
                <a href="#">cswaney.github.io</a>
            </li>
            <!-- <li>
                <p class="uk-text-center uk-text-small">Created with <a href="https://getuikit.com" uk-icon="icon: uikit; ratio: 1.0"></a></p>
            </li> -->
        </ul>
    </div>
</div>


        <!-- convert MathJax to KaTex -->
        <script>
          $("script[type='math/tex']").replaceWith(function() {
              var tex = $(this).text();
              return katex.renderToString(tex.replace(/%.*/g, ''), {displayMode: false});
          });

          $("script[type='math/tex; mode=display']").replaceWith(function() {
              var tex = $(this).html();
              return katex.renderToString(tex.replace(/%.*/g, ''), {displayMode: true});
          });
        </script>

    </body>

</html>
